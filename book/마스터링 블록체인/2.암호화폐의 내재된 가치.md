# 🔴 암호화폐의 내재된 가치

## 🟠 암호화폐 시스템의 공개키와 개인키

### 🟢 암호화

암호화는 수천년 전부터 정보를 보호하기 위한 용도로 주로 전쟁에서 사용되어 왔다. 

현대에서 기계와 컴퓨터의 사용이 암호화 사용을 촉진시켰고 네트워크의 발전에 따라 모든 사람이 암호화를 사용하고 있는 시대가 되었다.

### 🟢 비트코인과 공개키, 개인키

공개키는 누구나 쉽게 메세지를 암호화하고 접근할 수 있고 해당 정보를 보기 위해서는 개인키를 사용해야만 암호화한 메세지를 해독할 수 있다.

비트코인에서도 해당 요소는 중요한 요소로 작동한다. 

![img.png](image/암호화폐의%20재재된%20가치/비트코인%20주소를%20찾는%20과정.png)

비트코인에서 개인키는 공개키를 생성하는데 사용이 되고 이렇게 생성된 공개키는 비트코인의 주소를 생성하는데 사용된다.

비트코인의 주소는 공개키로서 누구에게나 공유할 수 있지만 그외에 모든 행동에는 개인키로서 보안을 유지할 수 있다.

## 🟠 UTXO 모델

### 🟢 Unspent Transaction Outputs(UTXO)

비트코인 거래는 미지출 트랜잭션 출력이라는 방식을 따른다.

거래는 입력 목록과 출력 목록으로 구분된다. 각 입력은 과거에 받은 주소와 함께 작므을 제공하는 비트코인 주소가 있는 UTXO를 식별한다.

각 출력은 비트코인 주소와 주소가 얼마나 많은 돈을 받는지 보여준다. 입력값과 출력값에 대한 비트코인의 차이는 마이너(채굴자)에 대한 수수료다.

각 입력에는 비트코인 주소의 소유자가 거래를 승인한다는 디지털 서명도 포함되어 있다.

![img.png](image/암호화폐의%20재재된%20가치/비트코인%20거래%20트랜잭션.png)

### 🟢 Row Transaction

```text
0100000001e3c8d3e1457cf52e8c53e3a6e477d70a2f9d4c2735ae0e1b55f77b4d4476b8b8010000006a47304402207895b60dbd6f1d15cb70d08eeb7d8e30d62089cc78897a0f2133d7cf3d4983f9022043ebff43f49c3b21f1f9d9e2d6fba758ef315ccf1f5c3947a4b0d9dcce18c4b7012103b287eac35f8f157c586a3f56f21a6d8e148be508c6f735f80179a957eb7a548cffffffff01f0ca052a010000001976a9145d1b25c6f788f8480f1c54757e35dbf29ec5f5f988ac00000000
```

비트코인 거래에 대한 트랜잭션은 위의 예시와 같다.

해당 트랜잭션을 해석해본다면 다음과 같이 구분할 수 있다.

| 항목                 | 값                                                                                                   | 설명 |
|----------------------|------------------------------------------------------------------------------------------------------|------|
| **Version**          | `01000000`                                                                                           | 버전: 1 |
| **Input Count**      | `01`                                                                                                 | 인풋 1개 |
| **Input TxID**       | `e3c8d3e1457cf52e8c53e3a6e477d70a2f9d4c2735ae0e1b55f77b4d4476b8b8`                                     | 사용된 UTXO의 트랜잭션 ID (리틀 엔디안) |
| **Vout**             | `01000000`                                                                                           | 위 TxID의 몇 번째 output인지 (1번 output = 2번째) |
| **ScriptSig Size**   | `6a` (106 bytes)                                                                                     | 서명 스크립트 길이 |
| **ScriptSig**        | `47304402207895b60dbd6f1d15...3b287eac35f8f157...`                                                    | 서명 + 공개키 포함 |
| **Sequence**         | `ffffffff`                                                                                           | 기본 시퀀스 (표준값) |
| **Output Count**     | `01`                                                                                                 | 출력 1개 |
| **Value**            | `f0ca052a01000000`                                                                                   | 전송 금액: 50,000,000 satoshi = 0.5 BTC |
| **ScriptPubKey Size**| `19` (25 bytes)                                                                                      | 출력 스크립트 길이 |
| **ScriptPubKey**     | `76a9145d1b25c6f788f8480f1c54757e35dbf29ec5f5f988ac`                                                 | P2PKH 형식 (수신자 주소의 스크립트) |
| **Locktime**         | `00000000`                                                                                           | 즉시 유효 (Locktime 없음) |

### 🟢 Transaction

암호화폐에서 트랜잭션은 한 주소에서 다른 주소로 이동했음을 나타낸다. 블록체인에 게재된 트랜잭션은 Confirmed 됐다고 표현한다.

비트코인을 양도하려면 개인키로 트랜잭션에 서명해야 한다. 그 후 해당 공개키는 수신자가 서명을 확인하고 트랜잭션을 검증하는 데 사용된다.

암호화폐에서 트랜잭션이 성사되기 위해 네트워크에 수수료를 지불해야 하고 이는 거래가 포함된 블록을 발견한 마이너에게 돌아간다.

수수료는 네트워크 용량과 신속한 확인이 얼마나 필요한지에 따라 변겨오딜 수 있다. 더 높은 수수료를 제공할 수록 마이너들이 빠르게 확인할 가능성이 높아지는 것이다.

![img.png](image/암호화폐의%20재재된%20가치/비트코인%20트랜잭션%20실행%20과정.png)

### 🟢 머클루트

머클루트는 현재 블록의 모든 트랜잭션 상태를 스냅샷으로 보여줄 때 사용된다. 머클루트를 사용하면 해당 블록에 대해 검증을 진행할 때 모든 트랜잭션 내용을 검증할 필요가 없이 머클루트만 비교하면 된다.

![img.png](image/암호화폐의%20재재된%20가치/머클루트%20구조.png)

위의 그림과 같이 머클 루트는 (Ha + Hb) + (Hc + Hd) = 머클루트 (Hab cd)가 된다

만약 트랜잭션 수가 홀수이면 가장 마지막 트랜잭션이 복사되어 처리된다.

### 🟢 트랜잭션 서명 및 검증

비트코인은 ECDSA 알고리즘을 사용하여 서명과 검증을 진행한다

![img.png](image/암호화폐의%20재재된%20가치/서명.png)

개인키를 사용하여 서명을 진행한다

![img_1.png](image/암호화폐의%20재재된%20가치/서명%20검증.png)

공개키와 서명을 통해 검증을 진행한다

검증은 공개키로 모두가 쉽게 검증이 가능하고 서명은 개인키가 필요하다

### 🟢 코인베이스 트랜잭션

모든 블록에 첫 번째로 기록된 트랜잭션을 코인베이스 트랜잭션이라고 한다.

코인베이스 트랜잭션은 블록보상, 거래 수수료로 구성되어 있다.

- 블록보상
  - 마이너가 비트코인 네트워크 유지를 위해 블록 발견 작업을 수행하고 네트워크로부터 받는 보상이다.
- 거래 수수료
  - 현재 블록에 추가되는 각 트랜잭션 수수료의 총합을 의미한다. 블록에 들어갈 수 있는 것보다 더 많은 트랜잭션이 처리 대기 중이여서 빠른 처리를 위해 트랜잭션 수수료 시장이 형성되는 경우가 많다.

### 🟢 비트코인 트랜잭션 보안

비트코인 트랜잭션은 푸시(송금), 풀(수신)로 나눠진다.

푸시 트랜잭션은 거래를 시작할 때 송금자 자신의 계좌 정보를 토출할 필요가 없다. 그렇기 때문에 안정성 측면에서 월등히 안전하다.

풀 트랜잭션은 계정 세부 정보를 수신자와 공유하도록 요구하기 때문에 보안성이 떨어진다. 이러한 약점을 보완하기 위해 풀 결제 네트워크는 과금 또는 거래에 이의를 제기하고 환불을 요청할 수 있다.

### 🟢 블록 해시

블록 해시는 블록이 생성되는 순간에 전체 블록체인이 어떤 모습이였는지 보여주는 스냅샷이다.

| 항목                 | 값               | 바이트크기 |
|--------------------|-----------------|-------|
| **Version**        | `블록 버전 번호`      | 4     |
| **hashPrevBlock**  | `이전 블록 헤더의 해시`  | 32    |
| **hashMerkleRoot** | `현재 블록 헤더의 해시`  | 32    |
| **time**           | `타임 스탬프(초단위)`   | 4     |
| **Bits**           | `현재 대상의 콤팩트 형식` | 4     |
| **Nonce**          | `32비트 숫자`       | 4     |

새로운 블록 해시를 생서앟ㄹ 때, 이전 블록 해시를 포함해 모든 블록이 이전 블록에 연결되도록 한다.

## 🟠 커스터디

금융 서비스에서 커스터디는 자산을 보유, 이동, 보호할 수 있는 능력을 말한다.

암호화폐 자산을 저장하는 방법이 다양하므로 커스터디를 지원하는 개념은 알아두는 것이 좋다.

### 🟢 수탁형

가상자산에서 가장 중요한 것은 개인키이다. 수탁형에서는 개인키를 업체에서 소유하고 제어한다.

사용자는 웹 인터페이스를 통해 가상자산에 대한 권한에 접근할 수 있고 개인키 관리에 신경 쓰지 않아도 된다.

수탁형의 가장 큰 단점은 업체가 파산하거나 자금을 가지고 도망치는 경우 사용자는 아무런 조치를 할 수 없다는 것이다.

업체 예시로는 코인베이스, 빗썸, 코인원 등이 있다.

### 🟢 비수탁형

사용자에게 개인키를 직접 관리하도록 한다. 개인키의 분실은 전적으로 사용자에게 책임이 있다.

업체 예시로는 블록체인닷컴과 같은 업체가 있다.

### 🟢 핫 월렛
인터넷에 연결되어 있어 거래를 생성할 때 키를 쉽게 사용할 수 있다. 그만큼 자금 이동이 쉽다는 의미이다.

- 웹 월렛
  - 브라우저를 통해 견결되는 웹사이트 기반 지갑이다
- 데스크톱 월렛
  - 윈도우, 맥, 리눅스와 같은 컴퓨터에서 실행되는 소프트웨어이다
- 모바일 월렛
  - 모바일 기기 기반 지갑이다

### 🟢 콜드 월렛
개인키가 완전히 오프라인으로 저장되는 지갑이다. 예를 들면 종이와 같은 물리적인 물체에 저장되는 것이다. 대형 암호화폐 업체들은 안전한 보관을 위해 대부분 콜드 월렛을 이용한다.

- 하드웨어 지갑
  - 개별 사용자에게 콜드 월렛으로 보관할 수 있게 해준다.
- 페이퍼 월렛
  - 개인키를 인쇄하거나 물리적인 물건에 적어 안전한 오프라인 어딘가에 저장하는 방법이다

## 🟠 보안

개인키는 지갑에 접근하는 권한이 생기는 것이기 때문에 절대로 잃어버리면 안되는 키이다. 그렇기에 해커들은 개인키를 노리는 공격을 진행한다.

### 🟢 예방

- 신원 검증
  - 가상자산 거래시 신원이 확실하거나 신뢰할 수 있는 사이트에서 거래를 진행해야 한다
- 2단계 인증
  - 기본 암호 이외에 2단계 인증을 진행하여 송금시 방지하는게 좋다.
  - 휴대폰 인증과 같은 경우는 해커들이 탈취하기 편하므로 Auth나 Google OTP 와 같이 탈취가 어려운 방법을 선택하는 것을 권장한다

### 🟢 공격 방법

- 휴대폰 포팅
  - 포팅은 공격할 대상의 전화번호로 들어오는 메세지를 가로채가는 공격이다
  - 이 때문에 2차 인증으로 휴대폰 인증은 권장하지 않는다
- 피싱
  - 해커들이 이메일, 통화를 통해 상대방을 속여 개인정보를 탈취하는 공격이다
  - 자신을 정부 or 신뢰할 수 있는 조직이라 주장하며 개인정보를 탈취한다
  - 실제로 애플 공동 설립자인 스티브 워즈니악 조차도 피싱에 당해 비트코인을 해커들에게 송금하였다

## 🟠 채굴

채굴은 처음에는 일반인들이 마이너로 참가하여 보상을 받아가는 프로세스였다. 하지만 비트코인 가격이 오르고 전문 업체들이 등장하며 현재는 기업급에서 채굴을 진행하고 있다.

### 🟢 Block Generator

암호화폐는 증명이라는 합의 알고리즘을 사용하기 때문에 채굴이 필요하다.

비트코인의 경우 특정 패턴과 일치하는 해시를 만들어 퍼즐을 풀기 위해 계산을 실행함으로서 작업이 증명되고

해시는 완성되면 채굴되는 블록의 주소를 보여준다. 현재 퍼즐이 해결된 후에만 블록체인에 새로운 블록이 추가된다.

이를 채굴이라 한다.

비트코인은 2,016 블록마다 채굴 난이도를 조절하도록 설계되어 있어 퍼즐은 시간이 흐르면서 해결하기 어려워진다.

## 🟠 Proof Of Work (작업 증명)

합의는 블록체인 참가자들 사이에서 가치와 목표를 공유한 후 합의를 도출하는 방법으로 블록체인 네트워크의 중요한 동작 방식이다.

합의 방식은 작업 증명 방식과 지분 증명 방식이 가장 유효하게 사욛되고 있다.

작업 증명은 암호화폐 트랜잭션을 확인하고 비트코인 블록체인에 블록을 넣을 수 있게 한다.

비트코인 트랜잭션의 새로운 블록은 10분 마다 마이너에게 확인이 된다. 네트워크 안에 수천 명의 마이너 중 어떤 마이너가 새로운 블록을 확인할 권리를 얻을지에 대해 합의를 이끌어 내야 한다.

### 🟢 마이닝 프로세스

마이너가 새로운 블록을 발견하기 위해서는 다음을 기준으로 네트워크에서 유요한 것으로 간주되는 비트코인 블록 해시를 생성해야 한다.
1. 유효한 블록 헤더의 해시
2. 결과 블록 해시는 현재 네트워크 목표치보다 낮은 숫자다

target은 항상 유효한 블록 해시보다 높게 유지해야한다. difficulty는 유효한 블록 해시를 발견하는데 필요한 평균 시도 수다. 네트워크 hash rate는 네트워크 마이너들이 유효한 블록 해시를 생성하기 위해 초당 시도 수이다.

비트코인은 10분 간격으로 마이너들이 블록을 발견하도록 설계되어 있고 이를 위해 난이도를 계속해서 조절하고 있다.

난이도는 2,016개의 블록(약 14일)마다 10분 간격으로 2,016개의 블록을 채굴할 수 있도록 조절하고 있다.

채굴되는 블록의 개수에 따라 보상의 규모도 작아지도록 설계되어 있는데 이는 약 4년마다 보상이 반으로 줄어들게 되어 있다. 정해진 양의 비트코인이 계속해서 채굴될 수 있도록 조절한 것이다.

![img.png](image/암호화폐의%20재재된%20가치/작업%20증명%20프로세스.png)

마이너는 블록 해시를 생성하고 유효한지 체크하며 유효하지 않다면 Nonce를 증가시키며 계속해서 채굴을 진행한다. 그러다 유효한 블록 해시를 발견하면 네트워크에 전파를 진행한다.

### 🟢 트랜잭션 라이프 사이클

페이팔과 같은 일반적인 트랜잭션 라이프 사이클의 경우 거래내역을 입력한 후 엔터키를 누르고 페이팔에서 응답을 주면 종료된다.

하지만 가상자산에서의 트랜잭션 라이프 사이클은 주요 4단계로 진행된다.

1. 브로드캐스트
   - 유효한 비트코인 트랜잭션을 생성한 다음 트랜잭션 내역을 비트코인 네트워크에 광범위하게 전파한다
2. Unconfirmed/Mempool(언컴펌드/멤풀)
   - 네트워크의 모든 마이너가 트랜잭션을 수신함에 따라 트랜잭션을 mempool에 배치한다. mempool은 unconfirmed 상태이고 활성 상태로 저장된다.
   - 기본적으로 트랜잭션이 2주 이상 mempool에 있는 경우 비활성 상태로 간주되어 mempool에서 삭제된다.
3. 마이너에 의해 confirmed
   - 마이너가 새로운 블록을 발견하면, 마이너는 mempool에 있는 트랜잭션 중 선택하여 새로운 블록을 추가한다.
   - 수수료가 가장 높은 순으로 트랜잭션을 선택한다
   - 마이너가 해당 트랜잭션을 포함하는 블록을 자신의 블록체인에 추가하면 트랜잭션은 confirmed 상태로 간주된다.
4. 네트워크 confirmed
   - 블록이 새로운 블록 아래에 묻힐수록 네트워크가 그 블록을 포함시키는 합의를 이룰 가능성이 커진다. 트랜잭션은 네트워크가 블록체인에 포함시키는데 합의를 이뤘을 때 비트코인 네트워크 전체에 의해 confirmed 된것으로 간주된다.

### 🟢 Confirmed

비트코인은 적어도 거래가 6번의 confirmed가 되었을 때 안전하게 confirmed된 트랜잭션으로 간주한다.

## 🟠 Proof Of Stake (지분 증명)

지분 증명은 채굴의 필요성을 제거해 작업 증명을 개선하는 것을 목표로하는 합의 알고리즘이다.

암호화폐 보유자들은 의결권을 얻기 위해 네트워크의 선택될 기회를 갖는다. 스테이킹을 사용하면 노드 또는 밸리데이터로 역할을 수행할 수 있는 기회를 갖을 수 있다.

### 🟢 Proof Of Work와 Proof Of Stake

기존의 Proof Of Work의 경우 퍼즐을 가장 빨리 푸는 사람이 채굴을 진행할 수 있고 보상을 가져갈 수 있었다.

그렇기 때문에 고사양 장비를 통해 더 많은 전기를 소모하여 빠르게 문제를 해결하는게 목표였기에 환경적으로 문제가 있었다.

그에 비해 Proof Of Stake는 Staking(얼마나 많은 암호화폐 량을 걸었는지), 기간(얼마나 암호화폐를 오랫동안 소유했는지), 재산(특정 시간 이상 가장 많은 암호화폐를 유지 했는지) 등 다양한 기준에 따라 선택한다.

- 장점
  - 채굴이 없기에 블록을 만다는데 전기 에너지가 거의 소비되지 않아 친환경 적이다
  - 네트워크에 더 많이 투자하는 사람들에게 더 많은 통제권을 준다
- 단점
  - 네트워크에 더 많이 투자한 사람들이 더 많은 통제권을 갖게되어 중앙 집중화되어 있다
  - 많은 작업량 보다 많은 투자에 선택권을 주기에 부자와 가난한 사람들의 차이를 더 크게 만들 수도 있다

### 🟢 Proof Of Stake가 사용되기 시작한 이유

암호화폐의 처음 등장 개념은 전기비용을 노동비용과 같이 계산함으로서 참신한 아이디어가 되었었지만 

현재는 강력한 하드웨어를 통해 많은 전기를 사용하여 비효율적인 채굴을 진행하여 환경적인 문제가 발생하기도 하고 

일반 전기가 아닌 값싼 전력을 통해 사용하여 채굴을 진행하여 가치가 맞지 않는 채굴 방법이 진행되기도 하기 때문이다.

그에 비해 POS의 경우는 자신의 자산을 걸고 증명하는 절차를 진행하기 때문에 문제를 풀기위한 전력 소비도 없고 자산이 가치가 되기 때문에 최근 채택을 많이 하고 있다.

만약 POS를 통해 블록을 생산하는 인원이 부정행위를 한다면 Slashing 규칙에 의해 걸어둔 재산은 모두 몰수되어 정직하게 행동해야 한다.

### 🟢 그외에 합의 방법

Proof Of Storage, POroof Of History, Delegated Proof Of Stake 등 다양한 합의 방법에 대해 연구가 진행되고 제안되고 있다.

## 🟠 이해관계자

암호화폐 생태계에서 상호작용하는 이해관계자는 브로커, 거래소, 커스터디, 분석 서비스, 정보 제공자 이렇게 5가지로 나눠서 볼 수 있다.

### 🟢 브로커

암호화폐 거래의 진행을 돕는 중개 서비스이다. 암호화폐의 가격을 정해두고 초보자들도 간편하게 정해진 금액을 지불한다면 간단하게 구매가 가능한 구조이다.

### 🟢 거래소

우리가 주로 알고 있는 업비트, 빗썸과 같은 거래소이다. 브로커에 비해서는 구매가 조금 복잡하다. 마치 주식을 사듯이 구매 가격을 걸어두고 판매자와 매칭이 된다면 구매가 된다.

브로커에 대한 수수료가 없어지기에 브로커를 통해 구매하는 것보다 저렴하게 구매할 수 있다.

### 🟢 커스터디(보관 서비스)

암호화폐를 구매했다면 이제 보관을 해야하는데 이를 대신해주는 서비스이다. 핫, 웜, 콜드 월렛 등 서비스를 제공해주며 암호화폐를 보관하기 어려워하는 기업이나 개인에게 수수료를 받고 서비스를 해준다.

### 🟢 분석

암호화폐의 블록체인에는 많은 정보들이 들어있다. 이를 일반 사람들이 접근해서 보기 힘들기에 조금 더 보기 편하게 제공해주는 서비스이다.

![img.png](image/암호화폐의%20재재된%20가치/블록체인%20분석%20정보.png)

### 🟢 정보

블록체인 산업은 하루가 다르게 빠르게 변화하고 있다. 새로운 기업, 새로운 기술, 새로운 암호화폐들이 계속해서 생겨난다. 이러한 업계 소식과 연구 내용을 제공한다.

대표적으로는 코인 데스크가 있고 뉴욕타임스, 월스트릿, 블룸버그와 같은 주요 출판사들도 암호화폐 산업에 대한 내용을 제공하고 있다.